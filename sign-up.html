<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sign-up Page</title>
  <link rel="stylesheet" href="./bootstrap-5.1.3-dist/css/bootstrap.css" />
  <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous"> -->

  <link rel="stylesheet" href="signUp.css">
  <script src="https://use.fontawesome.com/3c538cc85f.js"></script>
</head>
<body onload="getPreviousDetails()">
  <div class="signUpWrapper">
    <!-- <video autoplay muted loop id="video-background">
      <source src="./assets/course-video.mp4">
    </video>  -->
    <div id="boxOne" class="handlingForm fw-bold shadow" style="color: white;">
      <div class="forTitle text-center">
        <h2 class="display-4">Welcome,</h2>
        <p class="text-warning">Please type in your details to sign-up and create a new <strong class="text-danger">swaga</strong> account</p>
        <small id="allEmptyIn" class="text-danger"></small>
      </div>
      <label id="fFirstName" for="forFirstName">First Name<span class="text-danger">*</span></label>
      <input type="text" placeholder="First Name" class="form-control  py-2 border-dark" id="forFirstName">
      <label id="fLastName" for="forLastName">Last Name<span class="text-danger">*</span></label>
      <input type="text" placeholder="Last Name" class="form-control  py-2 border-dark" id="forLastName">
      <label id="fuserName" for="forUsername">Username<span class="text-danger">*</span></label>
      <input type="text" placeholder="Choose Username" class="form-control  py-2 border-dark" id="forUsername">
      <label id="fEmail" for="forEmail">Email<span class="text-danger">*</span></label>
      <input type="email" placeholder="Enter Your Email" class="form-control  py-2 border-dark" id="forEmail">
      <label id="fPhoneN" for="forPhoneNo">Phone Number<span class="text-danger">*</span></label>
      <input type="number" placeholder=" Enter Your Phone Number " class="form-control mb-2 py-2 border-dark" id="forPhoneNo">
      <!-- <label for="forPhoneNo">Phone Number<span class="text-danger">*</span></label> -->
      <span class= "border border-dark p-2 rounded-3 d-flex my-2">
        <label>Date Of Birth:</label>&nbsp;
        <input type="date" class="border-white" id="dob">
      </span>
      <select name="" id="userSignUpGenders" class="py-2 rounded-3">
        <option  value="">Gender</option>
        <option value="male" id="mGender">Male</option>
        <option value="female" id="fGender">Female</option>
      </select>
      
      <form class="my-1">
        <label id="fPassword" class="mb-0" id="forpassword">Password<span class="text-danger fw-bold">*</span></label>
        <div class="password rounded-3">
          <input type="password" placeholder="Enter Your Password" id="password" class="form-control rounded-3">
          <img src="pass-hide.png" onclick="clickOne()" class="pass-icon" id="pass-icon">
        </div> 
      </form class="my-1">

      <form>
        <label id="fPasswordConfirm" class="mt-0" id="forpassword-confirm">Confirm Password<span class="text-danger fw-bold">*</span></label>
        <div class="password-confirm rounded-3 ">
          <input type="password" placeholder="Confirm Password" id="passwordConfirm" class="form-control rounded-3">
          <img src="pass-hide-confirm.png" onclick="clickTwo()" class="pass-icon-confirm " id="pass-icon-confirm">
        </div>
      </form>

      <h6 class="text-light fw-bold mt-3">Forgot Password?  <a href="#">Reset password</a></h6>
      <h6 class="text-light fw-bold">You already have account? <a href="./sign-in.html">Sign in here</a></h6>
      <div class="forFun d-grid">
        <button class="btn btn-primary fw-bold mt-2" onclick="createUserAcct()">Create account</button>
        <!-- <input type="button" class="btn btn-rounded" name="Button" id> -->
        

        <a href="./index.html" class="text-center my-1 text-primary display-6 text-decoration-none">Home</a>
      </div>
    </div>
    <!-- start create pin -->
    <hr>
    <div id="boxTwo" class="">
        <h6 class="text-center fw-bold">Create <span class="text-danger">*4 digits*</span> Secret PIN for your Transactions</h6>
      <form class="my-1">
        <label class="mb-0" id="forpin">Pin<span class="text-danger fw-bold">*</span></label>
        <div class="password rounded-3">
          <input type="password" placeholder="Enter Your Password" id="fPin" class="form-control rounded-3">
          <img src="pass-hide.png" onclick="clickOneo()" class="pass-icon" id="pass-icon">
        </div>
       
      </form class="my-1">
  
      <form class="">
        <label id="forPinConfirm" class="mt-0" id="forPinConfirm">Confirm Pin<span class="text-danger fw-bold">*</span></label>
        <div class="password-confirm rounded-3 ">
          <input type="password" placeholder="Confirm Password" id="fPinConfirm" class="form-control rounded-3">
          <img src="pass-hide-confirm.png" onclick="clickTwot()" class="pass-icon-confirm " id="pass-icon-confirm">
        </div>
      </form>
      <button class="btn btn-primary fw-bold" onclick="createPin()">Create Pin</button>
    </div>
    <img src="./userProfileImg.jpg" alt="" style="display: none;" id="myImg">
  </div>
  
<script>
  var allUsers = []
  var a;
  var b;
  function pass()
        {
          if(a==1)
          {
            document.getElementById('password').type='password';
            document.getElementById('pass-icon').src='pass-hide.png';
            a=0;
          }
          else
          {
            document.getElementById('password').type='text';
            document.getElementById('pass-icon').src='pass-show.png';
            a=1;
          }
          // pashHid()
        }

  // for passwor confirmation
  function passHid()
        {
          if(b==1)
          {
            document.getElementById('passwordConfirm').type='password';
            document.getElementById('pass-icon-confirm').src='pass-hide-confirm.png';
            b=0;
          }
          else
          {
            document.getElementById('passwordConfirm').type='text';
            document.getElementById('pass-icon-confirm').src='pass-show-confirm.png';
            b=1;
          }
        }
  // pass()
  function clickTwo(){
    pass()
    passHid()
  }
  function clickOne(){
    pass()
    passHid()
  }
  var c;
  var d;
  function passs()
        {
          if(c==1)
          {
            document.getElementById('fPin').type='password';
            document.getElementById('pass-icon').src='pass-hide.png';
            c=0;
          }
          else
          {
            document.getElementById('fPin').type='text';
            document.getElementById('pass-icon').src='pass-show.png';
            c=1;
          }
          // pashHid()
        }

  // for passwor confirmation
  function passHids()
        {
          if(d==1)
          {
            document.getElementById('fPinConfirm').type='password';
            document.getElementById('pass-icon-confirm').src='pass-hide-confirm.png';
            d=0;
          }
          else
          {
            document.getElementById('fPinConfirm').type='text';
            document.getElementById('pass-icon-confirm').src='pass-show-confirm.png';
            d=1;
          }
        }
  // pass()
  function clickTwot(){
    passs()
    passHids()
  }
  function clickOneo(){
    passs()
    passHids()
  }

  const getPreviousDetails=()=>{
            if (localStorage.bankUsers){
                allUsers = JSON.parse(localStorage.getItem("bankUsers"))
                console.log(allUsers)
            } 
        }
  
  let regexforFName = /^([A-Z][\w]+)$/;
  let regexforLName = /^([A-Z][\w]+)$/;
  let regexforMail  = /^([\w]+)([@])([\w]+)([.])([\w]+)$/;
  let regexforPhone  = /^([\d]{11})$/;
  // let regexforPass  = /^([\w]{6,9})$/;
  let regexforPass  = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/;
  let regexforPIN  = /^([\d]{4})$/;

  
  const createUserAcct = () =>{
    let acctNum = Math.ceil(Math.random()*10000000000)
    let cardNum = Math.ceil(Math.random()*10000000000000000)
    let cardId  = Math.ceil(Math.random()*1000)
    let regDate = new Date()
    let expiryDate = new Date()
    expiryDate.setDate(expiryDate.getDate() + 730) 

    var userObj = {
    signUpFirstname: forFirstName.value,
    signUpLastname: forLastName.value,
    signupUsername: forUsername.value,
    signUpEmail: forEmail.value,
    signUpPhoneNo: forPhoneNo.value,
    signupDob: dob.value,
    signUpGenders: userSignUpGenders.value,
    signUpUserPass: password.value,
    signUpUserPassCon: passwordConfirm.value,
    userTransactionPIN: fPin.value,
    forAcctNo: acctNum,
    registrationDate:regDate.toLocaleDateString(),
    accountBalance:0,
    transaction:[],
    forCardNo: cardNum,
    forCardId: cardId,
    forRegDate: regDate.toLocaleDateString(),
    forExpireDate: expiryDate.toLocaleDateString(),
    profilePicture:myImg.src
  }


  
    
      if(forFirstName.value == '' || forLastName.value == "" || forUsername.value == '' ||  forEmail.value == '' || forPhoneNo.value== '' || dob.value == '' || userSignUpGenders.value == '' || password.value == '' ||  passwordConfirm.value == ''){
    allEmptyIn.innerText = "Ensure to complete your form filling!!"
  }
  else if(!regexforFName.test(forFirstName.value)){
      // if(!regexforFName.test(forFirstName.value)){
        fFirstName.innerHTML = `<small class='text-danger'>Your Firstname must start with Uppercase!!!</small>`
      // }else{
      //   fFirstName.innerHTML = `<small class='text-success'>Successful</small>`
      // }
      // continue
      // fFirstName.innerHTML = `<small class='text-danger'>Fill in First Name input!!!</small>`
      // forFirstName.className ="form-control is invalid"
      // console.log(' Password is not correct')
      // continue;
    } else if (!regexforLName.test(forLastName.value)){
      // if (!regexforLName.test(forLastName.value)){
        fLastName.innerHTML =  `<small class='text-danger'>Your Lastname must start with Uppercase</small>`
    //    }else {
    //     fLastName.innerHTML =  `<small class='text-success'>Successful</small>`

    // }
    }
     else if (!regexforMail.test(forEmail.value)){
      // if (!regexforMail.test(forEmail.value)){
        fEmail.innerHTML = `<small class='text-danger'>Input correct email</small>`
      // } else {
      //   fEmail.innerHTML = `<small class='text-success'>Success</small>`
      // }
    } else if (!regexforPhone.test(forPhoneNo.value)){
      // if (!regexforPhone.test(forPhoneNo.value)){
        fPhoneN.innerHTML = `<small class='text-danger'>Input correct Phone Number</small>`
      // } else {
      //   fPhoneNo.innerHTML = `<small class='text-success'>Success</small>`
      // }
    } else if (!regexforPass.test(password.value)){
      // if (!regexforPass.test(password.value)){
        fPassword.innerHTML = `<small class='text-danger'>Use at least Uppercase and Lowercase letter, digits and special character, with minimum of 8 characters</small>`
      // } else {
      //   fPassword.innerHTML = `<small class='text-success'>Success</small>`
      // }
    }else if (password.value !=  passwordConfirm.value){
      // if (!regexforPass.test(password.value)){
        fPassword.innerHTML = `<small class='text-danger'>Password not match!!!</small>`
        fPasswordConfirm.innerHTML = `<small class='text-danger'>Password not match!!!</small>`
      // } else {
      //   fPassword.innerHTML = `<small class='text-success'>Success</small>`
      // }
    }
    else {
      // forFirstName.value = ''
      // forLastName.value = ''
      // forUsername.value = ''
      // forEmail.value = ''
      // forPhoneNo.value = ''
      // dob.value = ''
      // password.value = ''
      // passwordConfirm = ''

      allUsers.push(userObj)
      localStorage.setItem("bankUsers", JSON.stringify(allUsers))
      console.log(allUsers)
      boxOne.style.display = "none"
      boxTwo.style.display = "flex"
    }

    }
  
  const createPin = () =>{
    let allUsers = JSON.parse(localStorage.getItem("bankUsers"))
    let arrayLenght = allUsers.length
    let lastRegUserIndex = Number(arrayLenght-1)
    console.log(lastRegUserIndex);
    if(fPin.value == '' || fPinConfirm.value == ''){
    forpin.innerHTML = `<small class="text-danger"> Transaction PIN must contain 4 DIGITS!!!</small>`
    }else if (!regexforPIN.test(fPin.value)){
    forpin.innerHTML = `<small class="text-danger"> Transaction PIN must contain 4 DIGITS!!!</small>`
    }else if (fPin.value != fPinConfirm.value){
    forpin.innerHTML = `<small class="text-danger"> Transaction PIN not match!!!</small>`
    forPinConfirm.innerHTML = `<small class="text-danger"> Transaction PIN not match!!!</small>`
    }else{
      allUsers[lastRegUserIndex].userTransactionPIN = fPin.value;
      localStorage.setItem('bankUsers', JSON.stringify(allUsers))
      // alert("You successfully create new Pin!" `pres okay to continue`)
      window.location.href = "sign-in.html"
    }
    console.log(lastRegUserIndex);
    // console.log(lastRegUserIndex);
  }

</script>

  <script src="./bootstrap-5.1.3-dist/js/bootstrap.js"></script>
</body>
</html>